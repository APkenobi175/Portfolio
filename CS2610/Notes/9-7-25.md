# HTTP Servers

### Running an HTTP server
* Python has a builtin module for running an HTTP server
* The job of a server is to look at the request, look at the URI Uniform Resource Identifier, decide what file to send back and then send that file to the browser
* run command python -m http.server (like what I did in my telescop build)
* It will automatically pick the port 8000
* when an http request is made with just the / URI its looking for the index.html file
* to do that just go to localhost:8000
* we can specifically request files too by adding a / and adding the name of the file

### HTTP Server Architecture 

1. HttpServer
   2. This is the object that set s up the socket, binds it to a port, and listens to traffic
3. HttpEncoder
   4. Encodes data fropm request/response
4. Request
   5. Method:String
   6. Version:String
   7. Headers:Dict
   8. body:string
   9. uri:string
10. Response
    11. version:string
    12. code:number
    13. reason:string
    14. headers:dict
    15. body:string
16. Router
    17. Takes an incoming request and figures out which endpoint to call
    18. returns response to HTTP server, the encoder then encodes the data and sends it back via the response
18. Endpoint
    19. A function that takes in a request file and returns a response. Up to each endpoint to decide what to send back in the response
20. The request goes through the middlechain first then to the router

### Sequence

Server (recives request, passed onto encoder) -> Encoder (parse request and return request object back to server) -> Server (sends request) -> Router (Figures out which endpoint to go to) -> Endpoint (Do whatever it needs to do with the request, and respond back) -> Router (Send response back to Server) -> Server (Send response over to the encoder) -> Encoder (take response and turn it into bytes, return response) -> Server (Send bytes back over the network)



### Middleware

* Middleware is like interlocks in PLC programming. Instead of relying on the developer to implement these steps before things can take place we use middleware

So, we have our server, a middleware chain, then we have the router, then we have the endpoints

The idea is theres no reason to go to the router or endpoints if something in the middle says not to. Middleware can do many things
* Logging
* Authentication
* check IP addresses
* organize data
* Attach things to request object (user login details)
* Authorization 
* File reading and conversions
please see [middleware.py](middleware.py) for an example
* The order is REVERSED when calling the middleware chain
* they all look basically the same with a factory function and then a middleware function isnide it