# Decorators / Wrapped functions
* Similar to middleware
* Another python concept that Django Uses
### Exmaple of Decorators
```python

def log(func):
	def wrapped_func(x, y): # uses the same parameters as the functions
		# Do something with the input
		# call the function
		# do something with the output
		# Accepts the same arguments as the functions its wrapped around and returns the same thing too
		print(f"func was called with {x} and {y}")
		result = func(x,y)
		print(f"Result was {result}")
		return result
	return wrapped_func # similar to middleware

@log # this is the decorator. Common pattern nowadays
def do_multiplication(x,y):
	return x*y

@log
@log
@log
@log # it does it 4 times Django uses these for a whole bunch of stuff
def do_addition(x,y):
	return x+y


do_addition(4,2)

do_multiplication(4,2)


print(do_addition)
```


# Django Auth System
1. Don't delete anything anymore when you create a Django Application
2. Run the pre packaged migrations
3. You will now see authentication, session, and admin stuff in the sql tables. 
4. If you want to limit what someone can see based on if they are logged in

* Go to views.py
```python
from django.contrib.auth.decorators import login_required

@login_required
def index(req):
	return HttpResponse("Hello World")
```
* The way Django does this is through decorators! as you can see we are adding the built in @login_required decorator from Django!
* We specify it in the settings.py for the application. 
```python
LOGIN_URL = "PathToSignInPage" # example = "registrations/signin"
```

* Now with adding that it will automatically redirect you to the sign in page if you are not signed in

### Signing in
* In the registration app 
```python
from django.contrib.auth.models import User

user = User.objects.create_user(
	username=req.POST.get("Email")
	password = req.POST.get("Password")
	email = req.POST.get("email")
	first_name = req.POST.get("First Name")
	last_name = req.POST.get("Last_name")
)
```
* This will create and save the user for us
* There is also a function that will log the user in
```python
from django.contrib.auth import login, authenticate


login(req, user) # This will log the user in
```
* It uses a sessionid cookie thats how it works guys
* The authenticate module is also built in to django 
```python
user = authenticate(req, username=req.POST.get("email"), password=req.POST.get("password"))
if user is not None:
	return redirect("/")
return render(req sign in blah lah bah)
```

* There is also a logout function within the same module


### CRSF Attack
* This attack takes advantage of cookies being sent to servers
* Cross Site Request Forgery Attacl
* Django implements this automatically
* csrfViewMiddleware. Must be in all of your forms if you are missing one there will be an error
* This middleware detects theres a form and writes a crsf token to a cookie. the token is submitted and if it matches it'll be allowed if it doesn't it'll be rejected
* The csrf token is encrypted 

# Django Admin Application
* One of the greatest parts of Django
* Need the admin app installed
* and need path to admin site in urls
### Create a Django Admin
* run `python manage.py createsuperuser` and it will run you through creating a super user account
* then restart the server


### Admin.py
* If you have a model and want to manage it from the admin tool,
* Go to admin.py and register the model
```python
from .models import name

admin.site.register(name)
```
