# Cookies and Session Based Authentication
* Cookies is a way you can store data for your website
* Cookies is a way where you store data from your server onto your user's client

### How to Write a cookie in Django
* We can create a cookie in our views.py
* We first define the cookie
* Then we use the set_cookie function
```python
def index(req: HttpRequest):
	numVisits = 0
	res = HttpResponse(f"<h1> You have visited this page {numVisits + 1} times)
	res.set_cookie("Visits", numVisits + 1) # This creates the cookie with the value of the number of visits 
	res.set_cookie("Name", "Joseph")
	return res
```

### Reading Cookies
* Now that we have set the cookies we can read the cookies
```python
def index(req: HttpRequest):
	numVisits = int(req.COOKIES.get("visits", 0)) ### NEW LINE - This is how we get the information for the cookies

	res = HttpResponse(f"<h1> You have visited this page {numVisits + 1} times)
	res.set_cookie("Visits", numVisits + 1) # This creates the cookie with the value of the number of visits 
	res.set_cookie("Name", "Joseph")
	return res
```
* The cookies have to be deleted by the server or the user.
* You can store primitive data 
* Useful for remembering information about a user thats not super important if it gets lost

### What does it mean to be "Logged In"
* The server does not remember who is logged in
* With every request there must be something to identify the user
* We can do this with cookies
* After the user logins once the server uses the password and then passes the user ID into a cookie
* IF the user then does something else it uses the userID instead of asking for the password again
* Thats why if you clear your cookies you gotta login again 
* We are trading security for convencience. Only the user's computer should have that cookie. 
* Cookies are shared across google logins for google chrome


## How to Implement Session Based Authentication
* We will have 2 models
	1. User
		* User info
		* Name
		* Email
		* Password
	2. Session (Wether or not a user is logged in or not in the database)
		* Has a user ID
		* And a token 
			* Randomly generated string, very long as long as possible, and needs to be unique 
			* More than one session can't have the same token
			
### How it works
1. Client sends email/password to the server
2. Server recives email/passwords and goes and creates a user in the database
3. Once the user is done being created then the server will create a session in the database
4. The random string for the token will be generated
5. Server sends a redirect response (301) to the client and send a cookie to the client
6. The cookie will retain the session token
7. The session token is what we will use to identify the user

* The only difference between logging in and creating an account is that instead of creating the user, we will find the user in the database by their email and password


### Other Requests
* Other requests typically go through a middleware
* The client sends the cookie with the session token in it to the middleware
* The middleware is going to find the user by its session token
* The middleware will send the request with the user to the Endpoint (view)
* The endpoint will do what it does (get and return data)
* The endpoint will respond back to the middleware
* Then the middleware will respond back to the client
* The middleware could redirect the user to the login page if their cookie is not GOOD ENOGH!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


### Other Useful Information
* When the server sets a cookie it is palced int he header of the HTTP response
* When the client sends the cookie back to the server it will only be sent as a string
