# 11-24-25 CS2810

---

## MIPS Pipelines

### Pipeline utilization

1. Q: If we have code that runs all R-instructions what percentage of the MIPS pipeline will be used
    * 80% R-format does not access memory.

### IF

* IF for load (lw):
  * Load instruction from memory, calculate PC+4
  * Pass the instruction and PC+4 to the IF register

* Question: What do we need the instruction for in the next stage
  * Determine the registers to read. We need the instruction rs and rt fields to figure out whcih RF values to read.
  * We need the immediate field to sign extend for llater stages
  * And we need the instruction for later stages.

### ID (decode and read)

* ID for load (lw): (decode and read)
  * Sign extend the immediate field from the instruction
  * Read from RF
  * Pass the PC+4, instruction, RF1, RF2, and Immediate value to the ID register.
  * On the next cycle all this stuff becomes input for the next phase

### EX (Execute)

* EX for load (lw):

  * Calculate the branch address with pc+4
  * do the ALU op
  * Pass the branch instruction, zero, ALU result, and RF2 to the next phase

* Question: Why do we need to keep/pass RF2 for the next phase?
  * It is needed as dat for the memory
  * If we have a store instruction then we need to write the data read from the RF
  * So, we need this for the MEM stage


### MEM (Memory)

* MEM for load (lw)

  * Access Memory
  * pass branch to PC
  * Pass instruction, mem and ALU output to the next phase/register

### WB (Write Back)

* WB for load (lw)

  * Write back to RF

* Question: Where is the write register coming from
  * IF/ID pipelone register instruction
  * The IF/ID pipeline register is wired to control the register file
  * This means the selected write register will not be from the instruction in the WB stage

* Question: Which stage uses the sign-extended result
  * EX phase (execute)

---

## Pipeline Control

### Controller

* DO we need the instruction in every pipeline stage?
  * Yes
* The controller passes the information to every phase
* That is why ID is called the decode phase
* We decode the instruction into control signals for the pipeline
