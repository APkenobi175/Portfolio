# MIPS Functions Continued (Leaf VS Non-Leaf)

### Leaf Functions

* A leaf function is one that doesn't call any other procedures

### Non-Leaf Functions
* A Non-Leaf function is a function that does call another procedure. 
* NOn leaf procedures must back up the value of their return address before making a call to another procedure:

### Stack Organizaiton
* You need to keep track of $ra when you are making recursive calls
* THis is because you could get stuck in an infinite loop.
* YOu must store your arguments on the stack as well. 
* Arguments going in, and Return addresses. Make room for them in the stack
* In order to fix the execution of the recursive factorial procedure we need to use the stack to save values that would otherwise be overwritten when a recusrive call takes place.
* Don't forget about $sp, thats how you can get the addresses


# MIPS Machine Code (UNit 9)


### Program Exuction 
1. Program Counter holds the instruction address
2. INstructions are fetched from memory and sent to the control
3. Control logic decodes the instruction and tells the alu and register files what to do
4. ALU executres the instruction and results flow back to the register file
5. The control logic updates the program counter for the next instruction



### Machine Language
* Code is converted into machine language (0s and 1s)
* Example:
	* add R8, R17, R18
	* 00000010 00110010 01000000 00100000
* Format
	* First 6 Bits is an operation code
	* Second 5 bits is rs
	* Third 5 bits is rt
	* fourth 5 bits is rd
	* fifth 5 bits is shamt
	* sixth 6 bits is funct

* Opcode (Operation Code)
	* The type of operation we are doing 
	* Add
	* LW
* RS (Source 1):
	* The first input
	* The register of the first input
* RT (Source 2):
	* The second input
* RD (Destination):
	* The destination register
* Shamt
	* Shift amount (Used for shift instructions)
* Funct:
	* Function selector (Add = 32, sub = 34, etc)

* How many bits do you need to specify the register
	* 5 Bits for each register
	* There are 32 regiseters hence we need 5 bits

* Which register is 01000
	* This is register 8 which is $t0 in mips.
* What does 000000 10001 10010 01000 00000 100000 mean?
	* 000000 = R type of instruction
	* 10001 = Register 17 ($s1)
	* 10010 = Register 18 
	* 01000 = Register 8
	* 00000 = we are not shifting so its 0
	* 100000 = Add
	* Register 17 + Register 18 into Register 8

### R Type Instruction
* Example:
```
add $t8, $t3, $zero
```
1. Convert register names to register numbers
```
add $8, $11, $8
```
2. Assign parts to section
3. add = funct 100000
4. $8 = rd(dest) = 01000
5. $11 = rs(src1) = 01011
6. $0 = rt (src2) = 00000
7. Operation code is R type so its 000000
8. YOu don't have to memorize the codes they will be provided to you on exams
```
000000 01011 00000 01000 00000 100000
```

* Q: Under what circumstances will you use the shift
	* A shift right is essentially subtracting 6
	* Can be used to jump between registers very quicky





